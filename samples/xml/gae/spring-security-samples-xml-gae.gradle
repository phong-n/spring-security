apply plugin: 'io.spring.convention.spring-sample-war'
apply plugin: 'appengine'

buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath "com.google.appengine:gradle-appengine-plugin:$gaeVersion"
	}
}

appengine {
	downloadSdk = true
}

// Remove logback as it causes security issues with GAE.
configurations.runtime.exclude(group: 'ch.qos.logback')

dependencies {
	appengineSdk "com.google.appengine:appengine-java-sdk:$gaeVersion"

	providedCompile "javax.servlet:javax.servlet-api"

	compile project(':spring-security-core'),
			project(':spring-security-web'),
			"org.springframework:spring-beans",
			"org.springframework:spring-web",
			"org.springframework:spring-webmvc",
			"org.springframework:spring-context",
			"org.springframework:spring-context-support",
			"com.google.appengine:appengine-api-1.0-sdk:$gaeVersion",
			'javax.validation:validation-api',
			'org.hibernate:hibernate-validator',
			"org.slf4j:slf4j-api"

	runtime project(':spring-security-config'),
			project(':spring-security-taglibs'),
			"org.slf4j:jcl-over-slf4j",
			"org.slf4j:slf4j-jdk14",
			jstlDependencies
	testCompile "com.google.appengine:appengine-testing"

	testRuntime "com.google.appengine:appengine-api-labs:$gaeVersion",
				"com.google.appengine:appengine-api-stubs:$gaeVersion"

}

appengineRun.onlyIf { !gradle.taskGraph.hasTask(appengineFunctionalTest) }
